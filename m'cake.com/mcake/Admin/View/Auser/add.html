<extend name="Index/index" />
<block name="con">

    
<div class="page-title">
    <div class="title_left">
        <h3>用户添加</h3>
    </div>
</div>
<div class="x_panel">
    <div class="x_title">
        <h2>用户信息 <small>请认真填写</small></h2>
        <ul class="nav navbar-right panel_toolbox">
            <li>
            	<a class="collapse-link">
            		<i class="fa fa-chevron-up"></i>
            	</a>
            </li>
            <li class="dropdown">
                <a aria-expanded="false" role="button" data-toggle="dropdown" class="dropdown-toggle" href="#">
                	<i class="fa fa-wrench"></i>
                </a>
                <ul role="menu" class="dropdown-menu">
                    <li>
                    	<a href="#">Settings 1</a>
                    </li>
                    <li>
                    	<a href="#">Settings 2</a>
                    </li>
                </ul>
            </li>
            <li>
            	<a class="close-link"><i class="fa fa-close"></i></a>
            </li>
        </ul>
        <div class="clearfix"></div>
    </div>
	<div class="x_content">
	    <br>
	    <form class="form-horizontal form-label-left" method="post" action="{:U('Admin/Auser/insert')}" data-parsley-validate="" id="demo-form2" novalidate="">

	        <div class="form-group">
	            <label for="first-name" class="control-label col-md-3 col-sm-3 col-xs-12">用户账号 <span class="required">*</span>
	            </label>
	            <div class="col-md-6 col-sm-6 col-xs-12">
	                <input type="text" class="form-control col-md-7 col-xs-12" required="required" id="first-name" data-parsley-id="4702" name="ausername"><span></span>
	            </div>
	        </div>
	        
	        <div class="form-group">
	            <label for="last-name" class="control-label col-md-3 col-sm-3 col-xs-12">密码 <span class="required">*</span>
	            </label>
	            <div class="col-md-6 col-sm-6 col-xs-12">
	                <input type="password" class="form-control col-md-7 col-xs-12" required="required" name="apass" id="last-name" data-parsley-id="4073"><span></span>
	            </div>
	        </div>
	        <div class="form-group">
	            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="middle-name">确认密码</label>
	            <div class="col-md-6 col-sm-6 col-xs-12">
	                <input type="password" name="reapass" class="form-control col-md-7 col-xs-12" id="middle-name" data-parsley-id="0283"><span></span>
	            </div>
	        </div>
	        <div class="form-group">
	            <label class="control-label col-md-3 col-sm-3 col-xs-12">性别</label>
	            <div class="col-md-6 col-sm-6 col-xs-12">
	                <div data-toggle="buttons" class="btn-group" id="gender">
	                    <label data-toggle-passive-class="btn-default" data-toggle-class="btn-primary" class="btn btn-primary active">
	                        <input type="radio" checked="" value='1' name="asex" data-parsley-multiple="gender" data-parsley-id="5600"> &nbsp; 男 &nbsp;
	                    </label>
	                    <label data-toggle-passive-class="btn-default" data-toggle-class="btn-primary" class="btn btn-default">
	                        <input type="radio"  value='0' name="asex" data-parsley-multiple="gender" data-parsley-id="5600"> &nbsp; 女 &nbsp; 
	                    </label>
	                </div>
	            </div>
	        </div>
	        <div class="form-group">
	            <label class="control-label col-md-3 col-sm-3 col-xs-12">邮箱 <span class="required">*</span>
	            </label>
	            <div class="col-md-6 col-sm-6 col-xs-12">
	                <input type="text" required="required" class="date-picker form-control col-md-7 col-xs-12" id="birthday" data-parsley-id="3087" name="aemail"><span></span>
	            </div>
	        </div>
	        <div class="form-group">
	            <label class="control-label col-md-3 col-sm-3 col-xs-12">电话 <span class="required">*</span>
	            </label>
	            <div class="col-md-6 col-sm-6 col-xs-12">
	                <input type="text" required="required" class="date-picker form-control col-md-7 col-xs-12" id="birthday" data-parsley-id="3087" name="aphone"><span></span>
	            </div>
	        </div>
	        <div class="form-group">
	        		<label class="control-label col-md-3 col-sm-3 col-xs-12">组别 <span class="required">*</span></label>
	        		<select name="group_id" style="width: 150px;height:30px;margin-left:10px; padding: 2px;" size="1" aria-controls="example">
	        		<option value="">所属组别</option>
	        		<foreach name = "groups" item = "vo">
	        		<option value="{$vo['id']}">{$vo['title']}</option>
	        		</foreach>
	        		</select><span></span>
	        </div>
	        <div class="form-group">
	            <label class="control-label col-md-3 col-sm-3 col-xs-12">验证码 <span class="required">*</span>
	            </label>
	            <div class="col-md-6 col-sm-6 col-xs-12">
	            	<img src="{:U('Admin/Public/vcode')}" alt="" onclick="this.src=this.src+'?b'">
	                <input type="text" required="required" class="date-picker form-control col-md-7 col-xs-12" id="birthday" data-parsley-id="3087" name="vcode"><span></span>
	            </div>
	        </div>
	        <div class="ln_solid"></div>
	        <div class="form-group">
	            <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
	                <button class="btn btn-success" type="submit">添加</button>
	                <button class="btn btn-primary" type="reset">重置</button>
	            </div>
	        </div>

	    </form>
	</div>
</div>


<script type="text/javascript">
	//性别点击事件
	$('#gender label').click(function(){
		$('#gender label').attr('class','');
		$(this).attr('class','btn btn-primary active');
		$(this).siblings('label').attr('class','btn btn-default');
	})

	//判断两次密码是否一致
	var R = false;
	var E = false;
	var W = false;
	$('input[name=reapass]').blur(function() {
		/* Act on the event */
		//获取两次密码的值
		var v = $('input[name=apass]').val();
		var rv = $(this).val();
		//判断两次密码是否一致
		if(rv!=v){
			R = false;
			$(this).next().html('确认密码输入有误').css('color','red');
		}else{
			R = true;
			$(this).next().html('')
		}
	});
	//检测邮箱格式
	$('input[name=aemail]').blur(function() {
		/* Act on the event */
		//获取邮箱值
		var v = $(this).val();
		var reg = /^\w+@\w+\.(com|cn|net|hk|org|jp|com.cn)$/;
		//判断
		if(!reg.test(v)){
			E = false;
			$(this).next().html('请正确填写邮箱').css('color','red');
		}else{
			E = true;
			$(this).next().html('')
		}
	});
	
	$('input[name=ausername]').blur(function(){
		var ausername = $(this).val();
		if(!ausername){
			$(this).next().html('用户名不能为空').css('color','red');
			return false;
		}else{
			$(this).next().html('');
		};
	})
	
	$('input[name=aphone]').blur(function(){
		var aphone = $(this).val();
		var reg = /^1([3,5,8]{1})\d{9}$/;
		if(!reg.test(aphone)){
			W = false;
			$(this).next().html('请正确填写联系电话').css('color','red');
		}else{
			W = true;
			$(this).next().html('');
		};

	})

	$('input[name=apass]').blur(function(){
		var apass = $(this).val();
		if(!apass){
			$(this).next().html('密码不能为空').css('color','red');
			return false;
		}else{
			$(this).next().html('');
		};
	})
	
	//绑定提交
	$('#demo-form2').submit(function() {
		/* Act on the event */
		// $(this).empty();
		var vcode = $('input[name=vcode]').val();
		
		var group_id = $('select[name="group_id"]').val();

		$('input[name=reapass]').trigger('blur');
		$('input[name=aemail]').trigger('blur');
		$('input[name=apass]').trigger('blur');
		$('input[name=ausername]').trigger('blur');
		$('select[name=group_id]').trigger('blur');
		$('input[name=phone]').trigger('blur');

		
		
		if(!vcode){
			$('input[name=vcode]').next().html('请填写验证码').css('color','red');
			return false;
		}else{
			$('input[name=vcode]').next().html('');
		};
		
		
		if(!group_id){
			$('select[name=group_id]').next().html('请选择所属组别').css('color','red');
			return false;
		}else{
			$('select[name=group_id]').next().html('');
		}

		
		if(R&&E){
			return true;
		}else{
			return false;
		}
	});
</script>
       
</block>
